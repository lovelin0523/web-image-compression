!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ImageCompression=t():e.ImageCompression=t()}(self,(function(){return(()=>{"use strict";var e={579:(e,t,i)=>{var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$options=t,this.width=null,this.quality=.8,this.mimeType="jpeg",this.maxSize=0,this.minSize=0,this._init()}return n(e,[{key:"_init",value:function(){"object"==o(this.$options)||this.$options||(this.$options={}),this.$options.width&&"number"==typeof this.$options.width&&this.$options.width>0&&(this.width=this.$options.width),this.$options.quality&&"number"==typeof this.$options.quality&&this.$options.quality>0&&(this.quality=this.$options.quality),this.$options.mimeType&&"string"==typeof this.$options.mimeType&&(this.mimeType=this.$options.mimeType),this.$options.maxSize&&"number"==typeof this.$options.maxSize&&this.$options.maxSize>0&&(this.maxSize=this.$options.maxSize),this.$options.minSize&&"number"==typeof this.$options.minSize&&this.$options.minSize>0&&(this.minSize=this.$options.minSize)}},{key:"compress",value:function(e){var t=this;return new Promise((function(i,o){if(t.minSize>0&&e.size<=1024*t.minSize)i(e);else{var n=new FileReader;n.readAsDataURL(e);var s=new Image;n.onload=function(r){s.src=n.result;var a=document.createElement("canvas"),p=a.getContext("2d");s.onload=function(){var o=t._createFile(a,p,s,e);i(o)},s.onerror=function(e){o(new Error("加载图片失败"))}},n.onerror=function(e){o(new Error("读取文件失败"))}}}))}},{key:"_createFile",value:function(e,t,i,o){e.width=this.width||i.width,e.height=this.width?this.width/(i.width/i.height):i.height,t.drawImage(i,0,0,e.width,e.height);var n=e.toDataURL("image/"+this.mimeType,this.quality),s=this._dataBase64toFile(n,this._newFileName(o.name));return this.maxSize>0&&s.size>1024*this.maxSize&&(this.quality=this.quality<=0?0:this.quality-.01,s=this._createFile(e,t,i,o)),s}},{key:"_dataBase64toFile",value:function(e,t){for(var i=e.split(","),o=i[0].match(/:(.*?);/)[1],n=atob(i[1]),s=n.length,r=new Uint8Array(s);s--;)r[s]=n.charCodeAt(s);return new File([r],t,{type:o})}},{key:"_newFileName",value:function(e){var t=e.lastIndexOf(".");return e.substr(t),e.substr(0,t)+"."+this.mimeType}}]),e}(),r=i(306);console.log("%c感谢使用"+r.name+"，当前版本：%c v"+r.version+"\n%c如果你觉得"+r.name+"还不错，不妨去github点个star\ngithub地址：%c"+r.repository.url,"color:#808080;","color:#008a00","color:#808080;","color:#008a00"),e.exports=s},306:e=>{e.exports=JSON.parse('{"name":"web-image-compression","version":"1.0.3","description":"一款轻量且简单的web前端图片压缩插件","main":"dist/web-image-compression.js","private":false,"scripts":{"serve":"cross-env NODE_ENV=development webpack","build":"cross-env NODE_ENV=production webpack"},"author":"lingkai","license":"MIT","babel":{"presets":["env"],"plugins":[]},"devDependencies":{"babel-core":"^6.26.3","babel-loader":"^7.1.5","babel-preset-env":"^1.7.0","cross-env":"^7.0.3"},"repository":{"type":"git","url":"https://github.com/lovelin0523/web-image-compression"}}')}},t={};return function i(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,i),s.exports}(579)})()}));