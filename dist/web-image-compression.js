!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ImageCompression=t():e.ImageCompression=t()}(window,(function(){return function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$options=t,this.width=null,this.quality=.8,this.mimeType="jpeg",this.maxSize=0,this.minSize=0,this._init()}return n(e,[{key:"_init",value:function(){"object"==o(this.$options)||this.$options||(this.$options={}),this.$options.width&&"number"==typeof this.$options.width&&this.$options.width>0&&(this.width=this.$options.width),this.$options.quality&&"number"==typeof this.$options.quality&&this.$options.quality>0&&(this.quality=this.$options.quality),this.$options.mimeType&&"string"==typeof this.$options.mimeType&&(this.mimeType=this.$options.mimeType),this.$options.maxSize&&"number"==typeof this.$options.maxSize&&this.$options.maxSize>0&&(this.maxSize=this.$options.maxSize),this.$options.minSize&&"number"==typeof this.$options.minSize&&this.$options.minSize>0&&(this.minSize=this.$options.minSize)}},{key:"compress",value:function(e){var t=this;return new Promise((function(i,o){if(t.minSize>0&&e.size<=1024*t.minSize)i(e);else{var n=new FileReader;n.readAsDataURL(e);var r=new Image;n.onload=function(e){r.src=n.result;var s=document.createElement("canvas"),a=s.getContext("2d");r.onload=function(){var e=t._createFile(s,a,r);i(e)},r.onerror=function(e){o(new Error("加载图片失败"))}},n.onerror=function(e){o(new Error("读取文件失败"))}}}))}},{key:"_createFile",value:function(e,t,i){e.width=this.width||i.width,e.height=this.width?this.width/(i.width/i.height):i.height,t.drawImage(i,0,0,e.width,e.height);var o=e.toDataURL("image/"+this.mimeType,this.quality),n=this._dataBase64toFile(o,this._newFileName(file.name));return this.maxSize>0&&n.size>1024*this.maxSize&&(this.quality=this.quality<=.1?.1:this.quality-.1,n=this._createFile(e,t,i)),n}},{key:"_dataBase64toFile",value:function(e,t){for(var i=e.split(","),o=i[0].match(/:(.*?);/)[1],n=atob(i[1]),r=n.length,s=new Uint8Array(r);r--;)s[r]=n.charCodeAt(r);return new File([s],t,{type:o})}},{key:"_newFileName",value:function(e){var t=e.lastIndexOf(".");e.substr(t);return e.substr(0,t)+"."+this.mimeType}}]),e}(),s=i(1);console.log("%c感谢使用"+s.name+"，当前版本：%c v"+s.version+"\n%c"+s.name+"完全由个人开发，如果你觉得还不错的话，欢迎前往github给个star，感谢！\ngithub地址：%c"+s.github,"color:#808080;","color:#008a00","color:#808080;","color:#008a00"),e.exports=r},function(e){e.exports=JSON.parse('{"name":"web-image-compression","version":"0.0.3","description":"一款轻量且简单的web前端图片压缩插件","main":"dist/web-image-compression.js","private":false,"scripts":{"test":"echo \\"Error: no test specified\\" && exit 1","serve":"webpack --mode development","build":"webpack --mode production"},"author":"lingkai","license":"MIT","babel":{"presets":["env"],"plugins":[]},"devDependencies":{"babel-core":"^6.26.3","babel-loader":"^7.1.5","babel-preset-env":"^1.7.0","webpack":"^4.46.0","webpack-cli":"^4.5.0"},"github":"https://github.com/lovelin0523/web-image-compression"}')}])}));